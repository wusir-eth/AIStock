{
  "permissions": {
    "allow": [
      "Bash(npx create-next-app:*)",
      "Bash(npm init -y)",
      "Bash(npm pkg set:*)",
      "Bash(npm install:*)",
      "Bash(npx prisma generate:*)",
      "Bash(npx prisma db push:*)",
      "Bash(postcss.config.mjs << 'EOF'\n/** @type {import\\('postcss-load-config'\\).Config} */\nconst config = {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n};\n\nexport default config;\nEOF)",
      "Bash(npm run dev)",
      "Bash(pkill:*)",
      "Bash(perl:*)",
      "Bash(find:*)",
      "Bash(/Users/jinzhaowu/AIStock/lib/auth.ts << 'EOF'\nimport { NextAuthOptions } from 'next-auth';\nimport { secondMeClient } from './secondme';\n\nexport const authOptions: NextAuthOptions = {\n  providers: [\n    {\n      id: 'secondme',\n      name: 'SecondMe',\n      type: 'oauth',\n      authorization: async \\({ params }\\) => {\n        const callbackUrl = \\\\`\\\\${process.env.NEXTAUTH_URL}/api/auth/callback/secondme\\\\`;\n        return secondMeClient.getAuthUrl\\(callbackUrl, params?.state as string\\);\n      },\n      token: async \\({ params }\\) => {\n        const response = await secondMeClient.exchangeCodeForToken\\(\n          params?.code as string,\n          \\\\`\\\\${process.env.NEXTAUTH_URL}/api/auth/callback/secondme\\\\`\n        \\);\n        return {\n          accessToken: response.access_token,\n          refreshToken: response.refresh_token,\n          expiresAt: response.expires_in ? Date.now\\(\\) + response.expires_in * 1000 : undefined,\n        };\n      },\n      userinfo: async \\({ tokens }\\) => {\n        return await secondMeClient.getUserProfile\\(tokens.accessToken as string\\);\n      },\n      profile: \\(profile: any\\) => \\({\n        id: profile.id,\n        name: profile.username,\n        email: profile.email,\n        image: profile.avatar,\n      }\\),\n      clientId: process.env.SECONDME_CLIENT_ID,\n      clientSecret: process.env.SECONDME_CLIENT_SECRET,\n    },\n  ],\n  callbacks: {\n    async jwt\\({ token, user, account }\\) {\n      if \\(user && account\\) {\n        token.accessToken = account.access_token;\n        token.refreshToken = account.refresh_token;\n        token.secondMeId = user.id;\n      }\n      return token;\n    },\n    async session\\({ session, token }\\) => {\n      if \\(session.user\\) {\n        session.user.id = token.sub!;\n        session.user.accessToken = token.accessToken as string;\n        session.user.secondMeId = token.secondMeId as string;\n      }\n      return session;\n    },\n  },\n  pages: {\n    signIn: '/',\n  },\n  session: {\n    strategy: 'jwt',\n  },\n};\nEOF)",
      "Bash(curl:*)",
      "Bash(git init:*)",
      "Bash(git add:*)"
    ]
  }
}
